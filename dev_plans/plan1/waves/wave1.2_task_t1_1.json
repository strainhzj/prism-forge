{
  "_file_type": "task_definition",
  "_description": "Wave 1 ä»»åŠ¡ T1_1ï¼šé›†æˆ SQLite ä¸ sqlite-vec",
  "task_id": "T1_1",
  "name": "é›†æˆ SQLite ä¸ sqlite-vec",
  "sub_branch": "feat/phase1-wave1-t1_1",
  "assignee": "backend",
  "estimated_hours": 20,
  "priority": "critical",
  "status": "completed",
  "requirement_ref": [
    "F5.1",
    "F5.2"
  ],
  "dependencies": [],
  "output_artifacts": [
    "src-tauri/Cargo.toml (æ›´æ–°ä¾èµ–)",
    "src-tauri/src/database/init.rs (æ–°å»ºï¼Œè¿æ¥ç®¡ç†å•ä¾‹)",
    "src-tauri/src/database/migrations.rs (æ‰©å±•è¡¨ç»“æ„ v4-v8ï¼Œæ·»åŠ  sqlite-vec åŠ è½½)",
    "src-tauri/src/database/models.rs (æ–°å¢æ•°æ®æ¨¡å‹)",
    "src-tauri/src/database/repository.rs (æ›´æ–° ApiProviderRepositoryï¼Œæ·»åŠ æ–° Repository)",
    "src-tauri/src/database/mod.rs (æ›´æ–°æ¨¡å—å¯¼å‡º)"
  ],
  "implementation_steps": [
    {
      "step": 1,
      "title": "æ·»åŠ  Rust ä¾èµ–",
      "description": "åœ¨ Cargo.toml ä¸­æ·»åŠ  sqlite-vec å’Œç›¸å…³ä¾èµ–",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "commands": [
        "ç¼–è¾‘ src-tauri/Cargo.toml",
        "æ·»åŠ : sqlite-vec = { version = \"0.5\", features = [\"bundled\"] }",
        "chrono = { version = \"0.4\", features = [\"serde\"] } (å·²å­˜åœ¨)",
        "dirs = \"5.0\" (å·²å­˜åœ¨)",
        "å¯é€‰: once_cell = \"1.19\" (ä»…å½“ Rust < 1.70 æ—¶éœ€è¦)",
        "æ·»åŠ : log = \"0.4\" (ç”¨äºæ—¥å¿—è¾“å‡º)"
      ],
      "details": [
        "æ£€æŸ¥ Rust ç‰ˆæœ¬: rustc --version",
        "å¦‚æœ Rust >= 1.70: ä½¿ç”¨ std::sync::OnceLockï¼ˆæ ‡å‡†åº“ï¼‰",
        "å¦‚æœ Rust < 1.70: æ·»åŠ  once_cell ä¾èµ–å¹¶ä½¿ç”¨ once_cell::sync::OnceLock",
        "sqlite-vec çš„ bundled feature ä¼šå°†æ‰©å±•é™æ€é“¾æ¥ï¼Œæ— éœ€æ‰‹åŠ¨åŠ è½½ .dll/.so æ–‡ä»¶",
        "log ä¾èµ–ç”¨äº init.rs ä¸­çš„ log::info!() æ—¥å¿—è¾“å‡º"
      ],
      "verification": "cargo check ç¼–è¯‘é€šè¿‡"
    },
    {
      "step": "2a",
      "title": "ä¿®æ”¹ migrations.rs - ä½¿ run_migrations å¯å…¬å¼€è®¿é—®",
      "description": "å°† run_migrations() å‡½æ•°æ”¹ä¸º pubï¼Œä»¥ä¾¿ init.rs å¯ä»¥è°ƒç”¨",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/migrations.rs"
      ],
      "details": [
        "å°† fn run_migrations(conn: &mut Connection) æ”¹ä¸º pub fn run_migrations(conn: &mut Connection)",
        "migrate_v4() åˆ° migrate_v8() ä¿æŒç§æœ‰ï¼ˆä»… run_migrations() å†…éƒ¨è°ƒç”¨ï¼‰",
        "æ›´æ–° CURRENT_DB_VERSION ä» 3 æ”¹ä¸º 8",
        "æš‚ä¸å®ç° migrate_v4-v8 çš„å…·ä½“å†…å®¹ï¼ˆå°†åœ¨ Step 3 å®ç°ï¼‰",
        "ä»…ä¿®æ”¹å‡½æ•°å¯è§æ€§å’Œç‰ˆæœ¬å·ï¼Œç¡®ä¿ç¼–è¯‘é€šè¿‡"
      ],
      "verification": "cargo check ç¼–è¯‘é€šè¿‡ï¼Œrun_migrations ç°åœ¨å¯ä»¥ä»å¤–éƒ¨è°ƒç”¨"
    },
    {
      "step": "2b",
      "title": "åˆ›å»º init.rs - æ•°æ®åº“åˆå§‹åŒ–æ¨¡å—",
      "description": "åˆ›å»º init.rs å®ç°å…¨å±€å•ä¾‹è¿æ¥ç®¡ç†ï¼ˆä¾èµ– Step 2a çš„ pub run_migrationsï¼‰",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/init.rs"
      ],
      "prerequisites": [
        "Step 2a å¿…é¡»å…ˆå®Œæˆï¼ˆrun_migrations å¿…é¡»æ˜¯ pubï¼‰"
      ],
      "details": [
        "å®ç° get_db_path() å‡½æ•°ï¼Œä½¿ç”¨ dirs::home_dir() è·å– ~/.prism-forge/prism_forge.db",
        "å®ç° get_connection_shared() å‡½æ•°ï¼Œè¿”å› Result<Arc<Mutex<Connection>>> ä½¿ç”¨ OnceLock å•ä¾‹",
        "åœ¨è¿æ¥å»ºç«‹åç«‹å³è®¾ç½® PRAGMA foreign_keys = ON, PRAGMA busy_timeout = 30000",
        "è®¾ç½® PRAGMA journal_mode = WAL å¯ç”¨ WAL æ¨¡å¼",
        "å®ç° load_sqlite_vec_extension() å‡½æ•°ï¼Œè°ƒç”¨ vec_init() åŠ è½½æ‰©å±•",
        "åœ¨ get_connection_shared() ä¸­è°ƒç”¨ pub run_migrations() è‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»",
        "ä¸è¦åˆ›å»º DatabaseManager ç»“æ„ä½“ï¼Œç›´æ¥ä½¿ç”¨ get_connection_shared() è·å–å…¨å±€è¿æ¥",
        "å‚è€ƒ resources/wave1/database/03_code_templates.md çš„ init_rs_complete_template"
      ],
      "verification": "å•å…ƒæµ‹è¯•éªŒè¯å•ä¾‹æ¨¡å¼å’Œè¿æ¥è·å–"
    },
    {
      "step": 3,
      "title": "ç¼–å†™è¿ç§»è„šæœ¬ï¼ˆv4-v8ï¼‰",
      "description": "æ‰©å±• migrations.rs æ·»åŠ  v4-v8 è¿ç§»å‡½æ•°",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/migrations.rs"
      ],
      "details": [
        "è¿ç§»åˆ°ç‰ˆæœ¬ 4: åˆ›å»º sessions è¡¨ï¼ˆå«è§¦å‘å™¨å’Œç´¢å¼•ï¼‰",
        "è¿ç§»åˆ°ç‰ˆæœ¬ 5: åˆ›å»º messages è¡¨ï¼ˆå«å¤–é”®çº¦æŸï¼‰",
        "è¿ç§»åˆ°ç‰ˆæœ¬ 6: åˆ›å»º message_embeddings è™šæ‹Ÿè¡¨å’Œ message_embedding_map æ˜ å°„è¡¨",
        "è¿ç§»åˆ°ç‰ˆæœ¬ 7: åˆ›å»º saved_prompts è¡¨",
        "è¿ç§»åˆ°ç‰ˆæœ¬ 8: åˆ›å»º meta_templates è¡¨",
        "å‚è€ƒ resources/wave1/database/01_complete_schema_ddl.sql è·å–å®Œæ•´ DDL",
        "åœ¨ run_migrations() å‡½æ•°ä¸­æ·»åŠ å¯¹æ–°ç‰ˆæœ¬è¿ç§»çš„è°ƒç”¨",
        "BREAKING CHANGE: run_migrations() must be pub fn (init.rs needs to call it)"
      ],
      "sql_reference": "dev_plans/plan1/resources/wave1/database/01_complete_schema_ddl.sql",
      "verification": "æ•°æ®åº“åˆå§‹åŒ–åæ‰€æœ‰è¡¨ç»“æ„æ­£ç¡®ï¼ŒSELECT vec_version() è¿”å› 0.5.0"
    },
    {
      "step": 4,
      "title": "å®šä¹‰æ•°æ®æ¨¡å‹",
      "description": "åœ¨ models.rs ä¸­æ·»åŠ æ–°çš„ Rust ç»“æ„ä½“",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/models.rs"
      ],
      "details": [
        "æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ String ç±»å‹å­˜å‚¨ RFC3339 æ ¼å¼ï¼ˆå¦‚ chrono::Utc::now().to_rfc3339()ï¼‰",
        "ç»“æ„ä½“å®ç° Serialize/Deserialize traitï¼Œä½¿ç”¨ #[serde(rename_all = \"camelCase\")]",
        "Session åŒ…å« created_at å’Œ updated_at å­—æ®µ",
        "Message åŒ…å« created_at å­—æ®µï¼ˆç”¨äºå®¡è®¡ï¼‰",
        "MessageEmbedding, SavedPrompt, MetaTemplate éƒ½åŒ…å« created_at",
        "tags å­—æ®µå­˜å‚¨ JSON Array å­—ç¬¦ä¸²ï¼ˆå¦‚ \"[\"bugfix\", \"ui\"]\"ï¼‰",
        "tags åºåˆ—åŒ–ï¼šç›´æ¥ä½¿ç”¨ String ç±»å‹å­˜å‚¨ï¼Œååºåˆ—åŒ–æ—¶ä½¿ç”¨ serde_json::from_str::<Vec<String>>()",
        "tags è¾…åŠ©æ–¹æ³•ï¼šå¯é€‰å®ç° get_tags() -> Vec<String>, set_tags(Vec<String>) æ–¹æ³•",
        "âš ï¸ Message.timestamp vs created_at è¯­ä¹‰åŒºåˆ†:",
        "  - timestamp: æ¶ˆæ¯çš„åŸå§‹æ—¶é—´æˆ³ï¼ˆä» JSONL æå–ï¼Œä¿ç•™ Claude è®°å½•çš„æ—¶é—´ï¼‰",
        "  - created_at: å®¡è®¡æ—¶é—´æˆ³ï¼ˆè®°å½•æ’å…¥æ•°æ®åº“çš„æ—¶é—´ï¼Œç”¨äºè¿½è¸ªï¼‰",
        "  - ä¸¤è€…éƒ½ä½¿ç”¨ String ç±»å‹å­˜å‚¨ RFC3339 æ ¼å¼",
        "  - timestamp ç”¨äºä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æŒ‰æ—¶é—´æ’åºæ˜¾ç¤ºæ¶ˆæ¯ï¼‰",
        "  - created_at ç”¨äºå®¡è®¡å’Œè°ƒè¯•",
        "âš ï¸ å‘é‡å­˜å‚¨æ¶æ„è¯´æ˜:",
        "  - message_embeddings: vec0 è™šæ‹Ÿè¡¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆ rowidï¼‰",
        "  - message_embedding_map: æ˜ å°„è¡¨ï¼ˆmessage_id -> vec_row_idï¼‰",
        "  - MessageEmbedding.embedding å­—æ®µç±»å‹: String (å­˜å‚¨ JSON åºåˆ—åŒ–çš„ Vec<f32>)",
        "  - å‘é‡ç»´åº¦: 384ç»´ (BGE-small-en-v1.5)",
        "  - åºåˆ—åŒ–: Vec<f32> â†’ JSON å­—ç¬¦ä¸² (serde_json::to_string)",
        "  - ååºåˆ—åŒ–: JSON å­—ç¬¦ä¸² â†’ Vec<f32> (serde_json::from_str)",
        "  - æ’å…¥æµç¨‹: 1) å°† Vec<f32> è½¬ä¸º JSON 2) INSERT INTO message_embeddings è·å– rowid â†’ 3) INSERT INTO message_embedding_map",
        "  - æŸ¥è¯¢æµç¨‹: 1) æŸ¥è¯¢æ˜ å°„è¡¨è·å– vec_rowid â†’ 2) ä» vec0 è¡¨æŸ¥è¯¢å‘é‡ â†’ 3) JSON ååºåˆ—åŒ–ä¸º Vec<f32>"
      ],
      "models": [
        "pub struct Session { id, session_id, project_path, project_name, file_path, rating, tags, is_archived, is_active, created_at, updated_at }",
        "pub struct Message { id, session_id, uuid, parent_uuid, type, timestamp, offset, length, summary, parent_idx, created_at }",
        "pub struct MessageEmbedding { message_id, embedding, summary, created_at }",
        "pub struct SavedPrompt { id, session_id, category, title, content, rating, usage_count, tokens, created_at }",
        "pub struct MetaTemplate { id, key, name, content, description, is_active, updated_at }",
        "pub struct TokenStats { pub count: usize, pub estimated_cost: f64 }"
      ],
      "verification": "æ‰€æœ‰æ¨¡å‹å®ç° Serialize/Deserializeï¼Œcargo check é€šè¿‡"
    },
    {
      "step": 5,
      "title": "å®ç° CRUD æ“ä½œ",
      "description": "åœ¨ repository.rs ä¸­æ·»åŠ æ•°æ®è®¿é—®æ–¹æ³•",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/repository.rs"
      ],
      "details": [
        "BREAKING CHANGE: æ›´æ–° ApiProviderRepository å­˜å‚¨ Arc<Mutex<Connection>> è€Œé Connection",
        "ç§»é™¤ ApiProviderRepository::from_default_db() æ–¹æ³•",
        "æ·»åŠ  ApiProviderRepository::with_conn(Arc<Mutex<Connection>>) æ„é€ å‡½æ•°",
        "æ‰€æœ‰ Repository æ–¹æ³•å†…éƒ¨ä½¿ç”¨ conn.lock().map_err() è·å– Connection å¼•ç”¨ï¼ˆé¿å… unwrapï¼‰",
        "SessionRepository: å®ç° create, get_by_id, get_all, update, delete, get_active_sessions, get_by_project",
        "MessageRepository: å®ç° create, get_by_session, get_by_uuid, get_by_offset, delete_by_session",
        "MessageEmbeddingRepository: å®ç° insert, search_similar(threshold, limit), delete_by_message",
        "search_similar å‚æ•°ï¼šthreshold (é»˜è®¤ 0.7), limit (é»˜è®¤ 10)ï¼Œè¿”å› Vec<MessageEmbedding>",
        "SavedPromptRepository å’Œ MetaTemplateRepository æœ¬é˜¶æ®µä»…å®šä¹‰ç»“æ„ï¼ŒCRUD å»¶å",
        "æ—¶é—´æˆ³å¤„ç†ï¼šcreate() æ–¹æ³•è‡ªåŠ¨è®¾ç½® created_atï¼Œupdate() æ–¹æ³•è‡ªåŠ¨æ›´æ–° updated_at",
        "tags å¤„ç†ï¼šä½¿ç”¨è¾…åŠ©æ–¹æ³• get_tags()/set_tags() å¤„ç†åºåˆ—åŒ–å’Œç©ºå€¼"
      ],
      "methods": [
        "æ‰€æœ‰ Repository: pub fn with_conn(conn: Arc<Mutex<Connection>>) -> Self",
        "SessionRepository: create, get_by_id, get_all, update, delete, get_active_sessions, get_by_project",
        "MessageRepository: create, get_by_session, get_by_uuid, get_by_offset, delete_by_session",
        "MessageEmbeddingRepository: insert, search_similar(threshold: f32, limit: usize), delete_by_message"
      ],
      "verification": "å•å…ƒæµ‹è¯•è¦†ç›–æ‰€æœ‰ CRUD æ–¹æ³•"
    },
    {
      "step": "5.1",
      "title": "è¿ç§»ç°æœ‰æµ‹è¯•ä»£ç åˆ° Arc<Mutex<>>",
      "description": "å°†æ‰€æœ‰ç°æœ‰æµ‹è¯•ä»£ç è¿ç§»åˆ°ä½¿ç”¨ Arc<Mutex<Connection>> æ¨¡å¼",
      "status": "[ ]",
      "prerequisites": [
        "Step 5 å¿…é¡»å…ˆå®Œæˆï¼ˆæ‰€æœ‰ Repository æ›´æ–°å®Œæˆï¼‰"
      ],
      "files": [
        "src-tauri/src/database/repository.rs (mod tests)",
        "src-tauri/src/llm/manager.rs (mod tests, å¦‚å­˜åœ¨)"
      ],
      "details": [
        "æ›´æ–°æ‰€æœ‰æµ‹è¯•è¾…åŠ©å‡½æ•°ï¼šä½¿ç”¨ Arc::new(Mutex::new()) åŒ…è£…è¿æ¥",
        "ç¡®ä¿æµ‹è¯•è¾…åŠ©å‡½æ•°åœ¨ Arc::new() ä¹‹å‰æ‰§è¡Œ run_migrations()",
        "æ›´æ–°æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼šä½¿ç”¨ .lock().map_err() æ›¿ä»£ç›´æ¥è®¿é—®",
        "å‚è€ƒ wave1.5_templates.jsonï¼ˆ03_code_templates.mdï¼‰ç¬¬ 544-585 è¡Œçš„è¿ç§»æ¨¡æ¿",
        "è¿ç§»æ£€æŸ¥æ¸…å•ï¼š",
        "  1. æµ‹è¯•è¾…åŠ©å‡½æ•° setup_test_db() è¿”å› Arc<Mutex<Connection>>",
        "  2. æ‰€æœ‰ Repository::with_conn() æ¥æ”¶ Arc<Mutex<Connection>>",
        "  3. æ‰€æœ‰è®¿é—®ä½¿ç”¨ conn.lock().map_err() è€Œéç›´æ¥è®¿é—®",
        "  4. å¹¶å‘æµ‹è¯•ä½¿ç”¨ Arc::clone() ä¼ é€’è¿æ¥",
        "  5. LLMClientManager æµ‹è¯•æ›´æ–°æ„é€ å‡½æ•°è°ƒç”¨"
      ],
      "template_reference": "wave1.5_templates.json â†’ concurrent_test_template (ç¬¬ 544-585 è¡Œ)",
      "migration_checklist": [
        "æ›´æ–° repository.rs ä¸­ mod tests çš„ setup_test_db() å‡½æ•°",
        "æ›´æ–° manager.rs ä¸­ mod testsï¼ˆå¦‚å­˜åœ¨ï¼‰çš„æ•°æ®åº“åˆå§‹åŒ–",
        "éªŒè¯æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ï¼šcargo test --lib",
        "éªŒè¯å¹¶å‘æµ‹è¯•é€šè¿‡ï¼šcargo test --test repository concurrent",
        "ç¡®è®¤æ—  unwrap() panicï¼Œæ‰€æœ‰é”™è¯¯ä½¿ç”¨ .map_err() å¤„ç†"
      ],
      "verification": "æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ—  Mutex poison é”™è¯¯"
    },
    {
      "step": 6,
      "title": "æ›´æ–°æ¨¡å—å¯¼å‡º",
      "description": "æ›´æ–° mod.rs å¯¼å‡ºæ–°æ¨¡å—å’Œå‡½æ•°",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "files": [
        "src-tauri/src/database/mod.rs"
      ],
      "details": [
        "æ·»åŠ  pub mod init;",
        "æ·»åŠ  pub mod repository;",
        "å¯¼å‡º get_db_path, get_connection_shared ä» init æ¨¡å—",
        "å¯¼å‡ºæ–°çš„ Repository ç±»å‹",
        "å‚è€ƒ supplementary_templates ä¸­çš„ module_declaration_template"
      ],
      "template_reference": "module_declaration_template",
      "verification": "lib.rs å¯ä»¥å¼•ç”¨ database::init å’Œ database::repository"
    },
    {
      "step": 7,
      "title": "æµ‹è¯•å‘é‡åŠŸèƒ½",
      "description": "éªŒè¯ sqlite-vec æ‰©å±•åŠ è½½å’Œå‘é‡è·ç¦»è®¡ç®—",
      "status": "[x]",  // è¿›åº¦è·Ÿè¸ª: [ ] å¾…å¼€å§‹ | [~] è¿›è¡Œä¸­ | [x] å·²å®Œæˆ
      "test_sql": [
        "SELECT vec_version();",
        "SELECT distance('[0.1, 0.2]', '[0.3, 0.4]');"
      ],
      "verification": "èƒ½æ­£ç¡®æ‰§è¡Œå‘é‡è·ç¦»æŸ¥è¯¢ï¼Œè¿”å›ä½™å¼¦ç›¸ä¼¼åº¦"
    }
  ],
  "acceptance_criteria": [
    "AC1: æ•°æ®åº“æ–‡ä»¶åœ¨ ~/.prism-forge/prism_forge.db æ­£ç¡®åˆ›å»º",
    "AC2: æ‰§è¡Œ SELECT name FROM sqlite_master WHERE type='table' è¿”å›æ‰€æœ‰7å¼ è¡¨ï¼ˆapi_providers + 6å¼ æ–°è¡¨ï¼‰",
    "AC3: æ‰§è¡Œ SELECT vec_version() è¿”å›ç‰ˆæœ¬å· 0.5.0",
    "AC4: èƒ½æ’å…¥æµ‹è¯•æ•°æ®å¹¶æˆåŠŸæŸ¥è¯¢",
    "AC5: cargo test æµ‹è¯•å…¨éƒ¨é€šè¿‡",
    "AC6: ä»£ç è¦†ç›–ç‡ > 80%",
    "AC7: ApiProviderRepository å’Œ LLMClientManager ä½¿ç”¨ Arc<Mutex<Connection>> ä¸”æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆå«ç°æœ‰æµ‹è¯•è¿ç§»ï¼‰"
  ],
  "testing_checklist": [
    "TC1.1: éªŒè¯æ•°æ®åº“è¿ç§»ä»ç‰ˆæœ¬ 3 å‡çº§åˆ°ç‰ˆæœ¬ 8",
    "TC1.2: éªŒè¯ sessions è¡¨çš„è§¦å‘å™¨æ­£ç¡®å·¥ä½œï¼ˆis_active å”¯ä¸€æ€§ï¼‰",
    "TC1.3: éªŒè¯å¤–é”®çº¦æŸï¼ˆmessages.session_id -> sessions.session_idï¼‰",
    "TC1.4: éªŒè¯ message_embeddings è™šæ‹Ÿè¡¨èƒ½æ­£ç¡®å­˜å‚¨å‘é‡",
    "TC1.5: éªŒè¯å‘é‡è·ç¦»æŸ¥è¯¢è¿”å›æ­£ç¡®çš„ä½™å¼¦ç›¸ä¼¼åº¦",
    "TC1.6: éªŒè¯å¹¶å‘è¯»å†™ä¸ä¼šæŸåæ•°æ®åº“",
    "TC1.7: éªŒè¯ Mutex é”™è¯¯è¢«æ­£ç¡®å¤„ç†ï¼ˆä¸ panicï¼‰",
    "TC1.8: éªŒè¯ tags ç©ºå€¼å¤„ç†ï¼ˆç©ºå­—ç¬¦ä¸²ã€NULLã€æœ‰æ•ˆ JSONï¼‰"
  ],
  "performance_targets": {
    "_resource_reference": "dev_plans/plan1/resources/wave1/database/08_performance_benchmarks.md",
    "description": "è¯¦ç»†çš„æ€§èƒ½ç›®æ ‡å·²æå–åˆ°èµ„æºæ–‡ä»¶",
    "summary": "æ•°æ®åº“åˆå§‹åŒ– < 500ms, å‘é‡æ’å…¥ < 5ms, Top-5 æœç´¢ < 30ms (1000æ¡ 384ç»´)"
  },
  "notes": [
    "sqlite-vec bundled ç‰ˆæœ¬ä½¿ç”¨ vec_init() å‡½æ•°åˆå§‹åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨åŠ è½½ .dll/.so æ–‡ä»¶",
    "å‘é‡ç»´åº¦å›ºå®šä¸º 384 (BGE-small-en-v1.5)",
    "æ‰€æœ‰æ—¶é—´å­—æ®µä½¿ç”¨ RFC3339 æ ¼å¼å­˜å‚¨ï¼ˆ chrono::Utc::now().to_rfc3339()ï¼‰",
    "tags å­—æ®µç©ºå€¼å¤„ç†ï¼šç©ºå­—ç¬¦ä¸²ã€NULL å‡è§†ä¸ºç©ºæ•°ç»„ []",
    "ä¸åˆ›å»º DatabaseManagerï¼Œç›´æ¥ä½¿ç”¨ get_connection_shared() è·å–å…¨å±€å•ä¾‹",
    "æ—¶é—´æˆ³èµ‹å€¼ï¼šRepository çš„ create() å’Œ update() æ–¹æ³•è‡ªåŠ¨è®¾ç½® created_at/updated_atï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨è®¾ç½®",
    "æ—¶é—´æˆ³å¤„ç†è§„èŒƒï¼š",
    "  - Repository create() æ–¹æ³•ï¼šè‡ªåŠ¨è®¾ç½® created_atï¼Œå¿½ç•¥ä¼ å…¥çš„å€¼ï¼ˆå¦‚æœæœ‰ï¼‰",
    "  - Repository update() æ–¹æ³•ï¼šè‡ªåŠ¨æ›´æ–° updated_atï¼Œå¿½ç•¥ä¼ å…¥çš„å€¼ï¼ˆå¦‚æœæœ‰ï¼‰",
    "  - æ‰€æœ‰æ—¶é—´æˆ³ä½¿ç”¨ chrono::Utc::now().to_rfc3339() æ ¼å¼",
    "  - DDL ä¸­å·²ç§»é™¤ DEFAULT (datetime(\"now\"))ï¼Œç”± Repository å±‚ç»Ÿä¸€ç®¡ç†",
    "  - DDL ä¸­å·²ç§»é™¤ update_sessions_timestamp è§¦å‘å™¨ï¼Œç”± Repository update() æ–¹æ³•è´Ÿè´£",
    "BREAKING CHANGE: ApiProviderRepository å¿…é¡»è¿ç§»åˆ°ä½¿ç”¨ Arc<Mutex<Connection>>",
    "æ‰€æœ‰ Repository ç»Ÿä¸€ä½¿ç”¨ with_conn(Arc<Mutex<Connection>>) æ„é€ å‡½æ•°",
    "é”™è¯¯å¤„ç†ï¼šä½¿ç”¨ .lock().map_err() æ›¿ä»£ .lock().unwrap() é¿å… panic",
    "å¹¶å‘æ§åˆ¶ï¼šè®¾ç½® busy_timeout = 30sï¼Œä½¿ç”¨ WAL æ¨¡å¼æå‡å¹¶å‘æ€§èƒ½",
    "search_similar å‚æ•°ï¼šthreshold é»˜è®¤ 0.7ï¼ˆä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼Œlimit é»˜è®¤ 10",
    "Rust ç‰ˆæœ¬è¦æ±‚ï¼šstd::sync::OnceLock éœ€è¦ Rust 1.70+ï¼Œæ—§ç‰ˆæœ¬éœ€æ·»åŠ  once_cell ä¾èµ–",
    "æ—¶é—´æˆ³éªŒè¯å‡½æ•° validate_timestamp() å’Œ tags è¾…åŠ©æ–¹æ³•æ”¾ç½®åœ¨ models.rs ä¸­",
    "æµ‹è¯•è¾…åŠ©å‡½æ•°éœ€è¦åœ¨ Arc::new(Mutex::new()) ä¹‹å‰æ‰§è¡Œ run_migrations()",
    "concurrent_tests_location: src-tauri/src/database/repository.rs in #[cfg(test)] mod tests section",
    "",
    "ğŸ“š èµ„æºæ–‡ä»¶äº¤å‰å¼•ç”¨ï¼ˆéç ´åæ€§ä¿®å¤ v1.8.1 æ·»åŠ ï¼‰:",
    "  - Breaking Change æµ‹è¯•è¿ç§»å‚è€ƒ: wave1.5_templates.json (03_code_templates.md) ç¬¬ 544-585 è¡Œ",
    "  - LLMClientManager é€‚é…å‚è€ƒ: wave1.5_templates.json (03_code_templates.md) ç¬¬ 921-1082 è¡Œ",
    "  - å®Œæ•´ä»£ç æ¨¡æ¿é›†åˆ: dev_plans/plan1/resources/wave1/database/03_code_templates.md (11 ä¸ªæ¨¡æ¿)",
    "  - æ•°æ®åº“ DDL å‚è€ƒ: dev_plans/plan1/resources/wave1/database/01_complete_schema_ddl.sql",
    "  - Git åˆå¹¶ç­–ç•¥: wave1.4_integration.json ç¬¬ 21-59 è¡Œ (cargo_toml_merge_strategy)",
    "  - å›æ»šè®¡åˆ’: wave1.4_integration.json ç¬¬ 113-121 è¡Œ",
    "  - éªŒè¯æ£€æŸ¥ç‚¹: wave1.4_integration.json ç¬¬ 70-111 è¡Œ"
  ]
}